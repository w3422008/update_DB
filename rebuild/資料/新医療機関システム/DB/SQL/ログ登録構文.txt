各種ログ記録例（参考）
// アクセスログを記録
$stmt = $pdo->prepare("
    INSERT INTO access_logs (
        user_id, session_id, access_type, page_url, page_name, 
        http_method, request_params, response_status, response_time_ms, 
        ip_address, user_agent, referer, facility_id, department_id, 
        error_message, additional_info
    ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
");

$stmt->execute([
    $user_id,                                    // user_id
    session_id(),                               // session_id
    'page_access',                              // access_type
    $_SERVER['REQUEST_URI'],                    // page_url
    '医療機関一覧',                               // page_name
    $_SERVER['REQUEST_METHOD'],                 // http_method
    json_encode($_REQUEST),                     // request_params
    http_response_code(),                       // response_status
    $response_time_ms,                          // response_time_ms
    $_SERVER['REMOTE_ADDR'],                    // ip_address
    $_SERVER['HTTP_USER_AGENT'],                // user_agent
    $_SERVER['HTTP_REFERER'] ?? null,           // referer
    $user_facility_id,                          // facility_id
    $user_department_id,                        // department_id
    $error_message,                             // error_message
    json_encode($additional_info)               // additional_info
]);
・認証・セッション(ログイン・ログアウト時)
・ページアクセス(各ページの先頭で記録)
・API・データ操作
・ファイル操作(ファイルダウンロード・アップロード)

// セキュリティログを記録
$stmt = $pdo->prepare("INSERT INTO security_logs (user_id, event_type, severity, description, ip_address, user_agent, session_id) VALUES (?, ?, ?, ?, ?, ?, ?)");
$stmt->execute([$user_id, 'login_success', 'low', 'ログイン成功', $_SERVER['REMOTE_ADDR'], $_SERVER['HTTP_USER_AGENT'], session_id()]);
例）
・認証関連(ログイン成功時、ログアウト時、パスワード変更時)
・権限・アクセス制御(管理者機能アクセス時、データエクスポート時)
・異常察知(短時間でのログイン試行、アカウントロック時)


📅 記録タイミングのベストプラクティス
即座に記録
・ログイン成功/失敗
・権限エラー
・システムエラー

処理完了後に記録
・ページ表示完了後
・API レスポンス送信後
・ファイル操作完了後
定期的にまとめて記録
・大量のアクセスがある場合
・パフォーマンス重視の場合