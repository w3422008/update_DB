<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã‚¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« */
        .control-panel {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .url-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .url-group label {
            font-weight: bold;
            min-width: 80px;
        }

        .url-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 300px;
            font-size: 14px;
        }

        .load-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }

        .load-btn:hover {
            background: #2980b9;
        }

        .layout-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .layout-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .layout-btn:hover {
            background: #219a52;
        }

        .layout-btn.active {
            background: #e74c3c;
        }

        /* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ */
        .main-content {
            flex: 1;
            display: flex;
            gap: 10px;
            padding: 10px;
            overflow: hidden;
        }

        /* æ¨ªä¸¦ã³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .main-content.horizontal {
            flex-direction: row;
        }

        /* ç¸¦ä¸¦ã³ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .main-content.vertical {
            flex-direction: column;
        }

        /* ãƒ•ãƒ¬ãƒ¼ãƒ ã‚³ãƒ³ãƒ†ãƒŠ */
        .frame-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            min-width: 0;
            min-height: 0;
        }

        .frame-header {
            background: #34495e;
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .frame-title {
            font-weight: bold;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .frame-controls {
            display: flex;
            gap: 8px;
        }

        .frame-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .frame-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .iframe-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .page-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            color: #666;
        }

        .loading-overlay.hidden {
            display: none;
        }

        /* ã‚¨ãƒ©ãƒ¼è¡¨ç¤º */
        .error-message {
            padding: 20px;
            text-align: center;
            color: #e74c3c;
            background: #fdf2f2;
            border: 1px solid #e74c3c;
            border-radius: 4px;
            margin: 20px;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .control-panel {
                flex-direction: column;
                align-items: stretch;
            }

            .url-group {
                flex-direction: column;
                align-items: stretch;
            }

            .url-input {
                width: 100%;
            }

            .main-content {
                flex-direction: column !important;
            }

            .layout-controls {
                display: none;
            }
        }

        /* ãƒ—ãƒªã‚»ãƒƒãƒˆãƒœã‚¿ãƒ³ */
        .preset-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .preset-btn:hover {
            background: #8e44ad;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ãƒ‡ãƒ¥ã‚¢ãƒ«ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼ã‚¢</h1>
        <div class="control-panel">
            <div class="url-group">
                <label for="url1">ãƒšãƒ¼ã‚¸1:</label>
                <input type="url" id="url1" class="url-input" placeholder="https://example.com" value="template_editor.html">
                <button class="load-btn" onclick="loadPage(1)">èª­ã¿è¾¼ã¿</button>
            </div>
            
            <div class="url-group">
                <label for="url2">ãƒšãƒ¼ã‚¸2:</label>
                <input type="url" id="url2" class="url-input" placeholder="https://example.com" value="template_editor_simple.html">
                <button class="load-btn" onclick="loadPage(2)">èª­ã¿è¾¼ã¿</button>
            </div>
            
            <div class="layout-controls">
                <label>ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ:</label>
                <button class="layout-btn active" onclick="setLayout('horizontal')">æ¨ªä¸¦ã³</button>
                <button class="layout-btn" onclick="setLayout('vertical')">ç¸¦ä¸¦ã³</button>
            </div>
            
            <div class="preset-controls">
                <label>ãƒ—ãƒªã‚»ãƒƒãƒˆ:</label>
                <button class="preset-btn" onclick="loadPreset('test')">ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</button>
                <button class="preset-btn" onclick="loadPreset('local')">ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«</button>
                <button class="preset-btn" onclick="loadPreset('google')">Google & Yahoo</button>
                <button class="preset-btn" onclick="loadPreset('news')">ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆ</button>
            </div>
        </div>
    </div>

    <div class="main-content horizontal" id="mainContent">
        <!-- å·¦å´/ä¸Šå´ã®ãƒ•ãƒ¬ãƒ¼ãƒ  -->
        <div class="frame-container">
            <div class="frame-header">
                <div class="frame-title" id="title1">ãƒšãƒ¼ã‚¸1</div>
                <div class="frame-controls">
                    <button class="frame-btn" onclick="refreshPage(1)" title="æ›´æ–°">ğŸ”„</button>
                    <button class="frame-btn" onclick="openInNewTab(1)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã">â†—</button>
                </div>
            </div>
            <div class="iframe-wrapper">
                <iframe id="iframe1" class="page-iframe" src="about:blank"></iframe>
                <div class="loading-overlay" id="loading1">èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>
        </div>

        <!-- å³å´/ä¸‹å´ã®ãƒ•ãƒ¬ãƒ¼ãƒ  -->
        <div class="frame-container">
            <div class="frame-header">
                <div class="frame-title" id="title2">ãƒšãƒ¼ã‚¸2</div>
                <div class="frame-controls">
                    <button class="frame-btn" onclick="refreshPage(2)" title="æ›´æ–°">ğŸ”„</button>
                    <button class="frame-btn" onclick="openInNewTab(2)" title="æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã">â†—</button>
                </div>
            </div>
            <div class="iframe-wrapper">
                <iframe id="iframe2" class="page-iframe" src="about:blank"></iframe>
                <div class="loading-overlay" id="loading2">èª­ã¿è¾¼ã¿ä¸­...</div>
            </div>
        </div>
    </div>

    <script>
        // ç¾åœ¨èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹URL
        let currentUrls = ['', ''];

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿é–¢æ•°
        function loadPage(frameNumber) {
            const urlInput = document.getElementById(`url${frameNumber}`);
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            const title = document.getElementById(`title${frameNumber}`);
            
            let url = urlInput.value.trim();
            
            if (!url) {
                alert('URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®å ´åˆã®å‡¦ç†
            if (isLocalFile(url)) {
                loadLocalFile(url, frameNumber);
                return;
            }
            
            // ãƒ—ãƒ­ãƒˆã‚³ãƒ«ãŒæŒ‡å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯https://ã‚’è¿½åŠ 
            if (!url.includes('://')) {
                url = 'https://' + url;
            }
            
            // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤º
            loading.classList.remove('hidden');
            
            // iframeèª­ã¿è¾¼ã¿
            iframe.src = url;
            currentUrls[frameNumber - 1] = url;
            
            // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
            const displayUrl = url.length > 40 ? url.substring(0, 40) + '...' : url;
            title.textContent = `ãƒšãƒ¼ã‚¸${frameNumber}: ${displayUrl}`;
            
            // ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆ10ç§’ï¼‰
            const timeoutId = setTimeout(() => {
                loading.classList.add('hidden');
                showError(frameNumber, `ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: ${url}`);
            }, 10000);
            
            // iframeèª­ã¿è¾¼ã¿å®Œäº†æ™‚ã®å‡¦ç†
            iframe.onload = function() {
                clearTimeout(timeoutId);
                loading.classList.add('hidden');
                try {
                    // åŒä¸€ã‚ªãƒªã‚¸ãƒ³ã®å ´åˆã®ã¿ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
                    const iframeTitle = iframe.contentDocument?.title;
                    if (iframeTitle) {
                        title.textContent = `ãƒšãƒ¼ã‚¸${frameNumber}: ${iframeTitle}`;
                    }
                } catch (e) {
                    // ã‚¯ãƒ­ã‚¹ã‚ªãƒªã‚¸ãƒ³ã®å ´åˆã¯ç„¡è¦–
                    console.log('Cross-origin content loaded successfully');
                }
            };
            
            // ã‚¨ãƒ©ãƒ¼å‡¦ç†
            iframe.onerror = function() {
                clearTimeout(timeoutId);
                loading.classList.add('hidden');
                showError(frameNumber, `èª­ã¿è¾¼ã¿å¤±æ•—: ${url}`);
            };
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«åˆ¤å®š
        function isLocalFile(url) {
            return url.endsWith('.html') || url.endsWith('.htm') || 
                   (!url.includes('://') && !url.includes('.'));
        }
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
        async function loadLocalFile(filename, frameNumber) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            const title = document.getElementById(`title${frameNumber}`);
            
            loading.classList.remove('hidden');
            
            try {
                // fetch APIã‚’ä½¿ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã¿
                const response = await fetch(filename);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const content = await response.text();
                
                // Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ãƒ‡ãƒ¼ã‚¿URLã¨ã—ã¦è¨­å®š
                const dataUrl = 'data:text/html;charset=utf-8,' + encodeURIComponent(content);
                iframe.src = dataUrl;
                
                currentUrls[frameNumber - 1] = filename;
                title.textContent = `ãƒšãƒ¼ã‚¸${frameNumber}: ${filename}`;
                
                // èª­ã¿è¾¼ã¿å®Œäº†å¾Œã®å‡¦ç†
                iframe.onload = function() {
                    loading.classList.add('hidden');
                };
                
            } catch (error) {
                loading.classList.add('hidden');
                console.error('Local file load error:', error);
                showError(frameNumber, `ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å¤±æ•—: ${filename}\n${error.message}`);
            }
        }
        
        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤ºé–¢æ•°
        function showError(frameNumber, message) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const errorHtml = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>ã‚¨ãƒ©ãƒ¼</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            padding: 40px; 
                            background: #f8f9fa; 
                            color: #333;
                        }
                        .error-container { 
                            background: white; 
                            padding: 30px; 
                            border-radius: 8px; 
                            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                            text-align: center;
                        }
                        .error-icon { 
                            font-size: 48px; 
                            color: #e74c3c; 
                            margin-bottom: 20px; 
                        }
                        .error-title { 
                            font-size: 24px; 
                            color: #e74c3c; 
                            margin-bottom: 15px; 
                        }
                        .error-message { 
                            font-size: 16px; 
                            line-height: 1.6; 
                            color: #666;
                            white-space: pre-line;
                        }
                        .retry-btn {
                            background: #3498db;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 4px;
                            cursor: pointer;
                            font-size: 14px;
                            margin-top: 20px;
                        }
                        .retry-btn:hover {
                            background: #2980b9;
                        }
                    </style>
                </head>
                <body>
                    <div class="error-container">
                        <div class="error-icon">âš ï¸</div>
                        <div class="error-title">ãƒšãƒ¼ã‚¸ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</div>
                        <div class="error-message">${message}</div>
                        <button class="retry-btn" onclick="parent.loadPage(${frameNumber})">å†è©¦è¡Œ</button>
                    </div>
                </body>
                </html>
            `;
            iframe.srcdoc = errorHtml;
        }

        // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆå¤‰æ›´
        function setLayout(layout) {
            const mainContent = document.getElementById('mainContent');
            const buttons = document.querySelectorAll('.layout-btn');
            
            // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚¯ãƒ©ã‚¹ã‚’æ›´æ–°
            mainContent.className = `main-content ${layout}`;
        }

        // ãƒšãƒ¼ã‚¸æ›´æ–°
        function refreshPage(frameNumber) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            
            loading.classList.remove('hidden');
            iframe.src = iframe.src; // å¼·åˆ¶ãƒªãƒ­ãƒ¼ãƒ‰
        }

        // æ–°ã—ã„ã‚¿ãƒ–ã§é–‹ã
        function openInNewTab(frameNumber) {
            const url = currentUrls[frameNumber - 1];
            if (url) {
                window.open(url, '_blank');
            }
        }

        // ãƒ—ãƒªã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿
        function loadPreset(presetName) {
            const url1Input = document.getElementById('url1');
            const url2Input = document.getElementById('url2');
            
            switch (presetName) {
                case 'local':
                    url1Input.value = 'template_editor.html';
                    url2Input.value = 'template_editor_simple.html';
                    break;
                case 'google':
                    url1Input.value = 'https://www.google.com';
                    url2Input.value = 'https://www.yahoo.co.jp';
                    break;
                case 'news':
                    url1Input.value = 'https://www.nhk.or.jp/news/';
                    url2Input.value = 'https://www.asahi.com/';
                    break;
                case 'github':
                    url1Input.value = 'https://github.com';
                    url2Input.value = 'https://stackoverflow.com';
                    break;
                case 'test':
                    // ãƒ†ã‚¹ãƒˆç”¨ã®ã‚·ãƒ³ãƒ—ãƒ«ãªHTMLãƒšãƒ¼ã‚¸
                    const testPage1 = `
                        <html>
                        <head><title>ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸1</title></head>
                        <body style="padding: 40px; font-family: Arial, sans-serif; background: #e3f2fd;">
                            <h1 style="color: #1976d2;">ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸1</h1>
                            <p>ã“ã‚Œã¯ãƒ†ã‚¹ãƒˆç”¨ã®ãƒšãƒ¼ã‚¸ã§ã™ã€‚</p>
                            <p>ç¾åœ¨æ™‚åˆ»: ${new Date().toLocaleString()}</p>
                            <div style="background: white; padding: 20px; margin: 20px 0; border-radius: 8px;">
                                <h3>ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h3>
                                <ul>
                                    <li>é …ç›®1</li>
                                    <li>é …ç›®2</li>
                                    <li>é …ç›®3</li>
                                </ul>
                            </div>
                        </body>
                        </html>
                    `;
                    
                    const testPage2 = `
                        <html>
                        <head><title>ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸2</title></head>
                        <body style="padding: 40px; font-family: Arial, sans-serif; background: #f3e5f5;">
                            <h1 style="color: #7b1fa2;">ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸2</h1>
                            <p>ã“ã‚Œã¯2ç•ªç›®ã®ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã§ã™ã€‚</p>
                            <p>ç¾åœ¨æ™‚åˆ»: ${new Date().toLocaleString()}</p>
                            <div style="background: white; padding: 20px; margin: 20px 0; border-radius: 8px;">
                                <h3>åˆ¥ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h3>
                                <table border="1" style="border-collapse: collapse; width: 100%;">
                                    <tr><th style="padding: 8px;">åˆ—1</th><th style="padding: 8px;">åˆ—2</th></tr>
                                    <tr><td style="padding: 8px;">ãƒ‡ãƒ¼ã‚¿A</td><td style="padding: 8px;">ãƒ‡ãƒ¼ã‚¿B</td></tr>
                                    <tr><td style="padding: 8px;">ãƒ‡ãƒ¼ã‚¿C</td><td style="padding: 8px;">ãƒ‡ãƒ¼ã‚¿D</td></tr>
                                </table>
                            </div>
                        </body>
                        </html>
                    `;
                    
                    // ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’ç›´æ¥èª­ã¿è¾¼ã¿
                    document.getElementById('iframe1').srcdoc = testPage1;
                    document.getElementById('iframe2').srcdoc = testPage2;
                    document.getElementById('title1').textContent = 'ãƒšãƒ¼ã‚¸1: ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸1';
                    document.getElementById('title2').textContent = 'ãƒšãƒ¼ã‚¸2: ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸2';
                    url1Input.value = 'ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸1ï¼ˆå†…è”µï¼‰';
                    url2Input.value = 'ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸2ï¼ˆå†…è”µï¼‰';
                    return; // é€šå¸¸ã®èª­ã¿è¾¼ã¿å‡¦ç†ã‚’ã‚¹ã‚­ãƒƒãƒ—
            }
            
            // ä¸¡æ–¹ã®ãƒšãƒ¼ã‚¸ã‚’èª­ã¿è¾¼ã¿
            loadPage(1);
            loadPage(2);
        }

        // Enter ã‚­ãƒ¼ã§ã®èª­ã¿è¾¼ã¿
        document.getElementById('url1').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loadPage(1);
            }
        });

        document.getElementById('url2').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loadPage(2);
            }
        });

        // åˆæœŸèª­ã¿è¾¼ã¿
        window.addEventListener('load', function() {
            loadPage(1);
            loadPage(2);
        });

        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã®å‡¦ç†
        window.addEventListener('resize', function() {
            // ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºæ™‚ã¯å¼·åˆ¶çš„ã«ç¸¦ä¸¦ã³ã«
            if (window.innerWidth <= 768) {
                document.getElementById('mainContent').className = 'main-content vertical';
            }
        });
    </script>
</body>
</html>
