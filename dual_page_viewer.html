<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éá„É•„Ç¢„É´„Éö„Éº„Ç∏„Éì„É•„Éº„Ç¢</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header {
            background-color: #2c3e50;
            color: white;
            padding: 15px 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        /* „Ç≥„É≥„Éà„É≠„Éº„É´„Éë„Éç„É´ */
        .control-panel {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .url-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .url-group label {
            font-weight: bold;
            min-width: 80px;
        }

        .url-input {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 300px;
            font-size: 14px;
        }

        .load-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s ease;
        }

        .load-btn:hover {
            background: #2980b9;
        }

        .layout-controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .layout-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .layout-btn:hover {
            background: #219a52;
        }

        .layout-btn.active {
            background: #e74c3c;
        }

        /* „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ */
        .main-content {
            flex: 1;
            display: flex;
            gap: 10px;
            padding: 10px;
            overflow: hidden;
        }

        /* Ê®™‰∏¶„Å≥„É¨„Ç§„Ç¢„Ç¶„Éà */
        .main-content.horizontal {
            flex-direction: row;
        }

        /* Á∏¶‰∏¶„Å≥„É¨„Ç§„Ç¢„Ç¶„Éà */
        .main-content.vertical {
            flex-direction: column;
        }

        /* „Éï„É¨„Éº„É†„Ç≥„É≥„ÉÜ„Éä */
        .frame-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            overflow: hidden;
            min-width: 0;
            min-height: 0;
        }

        .frame-header {
            background: #34495e;
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
        }

        .frame-title {
            font-weight: bold;
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .frame-controls {
            display: flex;
            gap: 8px;
        }

        .frame-btn {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 3px;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .frame-btn:hover {
            background: rgba(255,255,255,0.2);
        }

        .iframe-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .page-iframe {
            width: 100%;
            height: 100%;
            border: none;
            background: white;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            color: #666;
        }

        .loading-overlay.hidden {
            display: none;
        }

        /* „Ç®„É©„ÉºË°®Á§∫ */
        .error-message {
            padding: 20px;
            text-align: center;
            color: #e74c3c;
            background: #fdf2f2;
            border: 1px solid #e74c3c;
            border-radius: 4px;
            margin: 20px;
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
        @media (max-width: 768px) {
            .control-panel {
                flex-direction: column;
                align-items: stretch;
            }

            .url-group {
                flex-direction: column;
                align-items: stretch;
            }

            .url-input {
                width: 100%;
            }

            .main-content {
                flex-direction: column !important;
            }

            .layout-controls {
                display: none;
            }
        }

        /* „Éó„É™„Çª„ÉÉ„Éà„Éú„Çø„É≥ */
        .preset-controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
        }

        .preset-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .preset-btn:hover {
            background: #8e44ad;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>„Éá„É•„Ç¢„É´„Éö„Éº„Ç∏„Éì„É•„Éº„Ç¢</h1>
        <div class="control-panel">
            <div class="url-group">
                <label for="url1">„Éö„Éº„Ç∏1:</label>
                <input type="url" id="url1" class="url-input" placeholder="https://example.com" value="template_editor.html">
                <button class="load-btn" onclick="loadPage(1)">Ë™≠„ÅøËæº„Åø</button>
            </div>
            
            <div class="url-group">
                <label for="url2">„Éö„Éº„Ç∏2:</label>
                <input type="url" id="url2" class="url-input" placeholder="https://example.com" value="template_editor_simple.html">
                <button class="load-btn" onclick="loadPage(2)">Ë™≠„ÅøËæº„Åø</button>
            </div>
            
            <div class="layout-controls">
                <label>„É¨„Ç§„Ç¢„Ç¶„Éà:</label>
                <button class="layout-btn active" onclick="setLayout('horizontal')">Ê®™‰∏¶„Å≥</button>
                <button class="layout-btn" onclick="setLayout('vertical')">Á∏¶‰∏¶„Å≥</button>
            </div>
            
            <div class="preset-controls">
                <label>„Éó„É™„Çª„ÉÉ„Éà:</label>
                <button class="preset-btn" onclick="loadPreset('test')">„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏</button>
                <button class="preset-btn" onclick="loadPreset('local')">„É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´</button>
                <button class="preset-btn" onclick="loadPreset('google')">Google & Yahoo</button>
                <button class="preset-btn" onclick="loadPreset('news')">„Éã„É•„Éº„Çπ„Çµ„Ç§„Éà</button>
            </div>
        </div>
    </div>

    <div class="main-content horizontal" id="mainContent">
        <!-- Â∑¶ÂÅ¥/‰∏äÂÅ¥„ÅÆ„Éï„É¨„Éº„É† -->
        <div class="frame-container">
            <div class="frame-header">
                <div class="frame-title" id="title1">„Éö„Éº„Ç∏1</div>
                <div class="frame-controls">
                    <button class="frame-btn" onclick="refreshPage(1)" title="Êõ¥Êñ∞">üîÑ</button>
                    <button class="frame-btn" onclick="openInNewTab(1)" title="Êñ∞„Åó„ÅÑ„Çø„Éñ„ÅßÈñã„Åè">‚Üó</button>
                </div>
            </div>
            <div class="iframe-wrapper">
                <iframe id="iframe1" class="page-iframe" src="about:blank"></iframe>
                <div class="loading-overlay" id="loading1">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
            </div>
        </div>

        <!-- Âè≥ÂÅ¥/‰∏ãÂÅ¥„ÅÆ„Éï„É¨„Éº„É† -->
        <div class="frame-container">
            <div class="frame-header">
                <div class="frame-title" id="title2">„Éö„Éº„Ç∏2</div>
                <div class="frame-controls">
                    <button class="frame-btn" onclick="refreshPage(2)" title="Êõ¥Êñ∞">üîÑ</button>
                    <button class="frame-btn" onclick="openInNewTab(2)" title="Êñ∞„Åó„ÅÑ„Çø„Éñ„ÅßÈñã„Åè">‚Üó</button>
                </div>
            </div>
            <div class="iframe-wrapper">
                <iframe id="iframe2" class="page-iframe" src="about:blank"></iframe>
                <div class="loading-overlay" id="loading2">Ë™≠„ÅøËæº„Åø‰∏≠...</div>
            </div>
        </div>
    </div>

    <script>
        // ÁèæÂú®Ë™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„ÇãURL
        let currentUrls = ['', ''];

        // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÈñ¢Êï∞
        function loadPage(frameNumber) {
            const urlInput = document.getElementById(`url${frameNumber}`);
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            const title = document.getElementById(`title${frameNumber}`);
            
            let url = urlInput.value.trim();
            
            if (!url) {
                alert('URL„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            // „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´„ÅÆÂ†¥Âêà„ÅÆÂá¶ÁêÜ
            if (isLocalFile(url)) {
                loadLocalFile(url, frameNumber);
                return;
            }
            
            // „Éó„É≠„Éà„Ç≥„É´„ÅåÊåáÂÆö„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑÂ†¥Âêà„ÅØhttps://„ÇíËøΩÂä†
            if (!url.includes('://')) {
                url = 'https://' + url;
            }
            
            // „É≠„Éº„Éá„Ç£„É≥„Ç∞Ë°®Á§∫
            loading.classList.remove('hidden');
            
            // iframeË™≠„ÅøËæº„Åø
            iframe.src = url;
            currentUrls[frameNumber - 1] = url;
            
            // „Çø„Ç§„Éà„É´Êõ¥Êñ∞
            const displayUrl = url.length > 40 ? url.substring(0, 40) + '...' : url;
            title.textContent = `„Éö„Éº„Ç∏${frameNumber}: ${displayUrl}`;
            
            // „Çø„Ç§„É†„Ç¢„Ç¶„ÉàË®≠ÂÆöÔºà10ÁßíÔºâ
            const timeoutId = setTimeout(() => {
                loading.classList.add('hidden');
                showError(frameNumber, `„Çø„Ç§„É†„Ç¢„Ç¶„Éà: ${url}`);
            }, 10000);
            
            // iframeË™≠„ÅøËæº„ÅøÂÆå‰∫ÜÊôÇ„ÅÆÂá¶ÁêÜ
            iframe.onload = function() {
                clearTimeout(timeoutId);
                loading.classList.add('hidden');
                try {
                    // Âêå‰∏Ä„Ç™„É™„Ç∏„É≥„ÅÆÂ†¥Âêà„ÅÆ„Åø„Çø„Ç§„Éà„É´„ÇíÂèñÂæó
                    const iframeTitle = iframe.contentDocument?.title;
                    if (iframeTitle) {
                        title.textContent = `„Éö„Éº„Ç∏${frameNumber}: ${iframeTitle}`;
                    }
                } catch (e) {
                    // „ÇØ„É≠„Çπ„Ç™„É™„Ç∏„É≥„ÅÆÂ†¥Âêà„ÅØÁÑ°Ë¶ñ
                    console.log('Cross-origin content loaded successfully');
                }
            };
            
            // „Ç®„É©„ÉºÂá¶ÁêÜ
            iframe.onerror = function() {
                clearTimeout(timeoutId);
                loading.classList.add('hidden');
                showError(frameNumber, `Ë™≠„ÅøËæº„ÅøÂ§±Êïó: ${url}`);
            };
        }
        
        // „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´Âà§ÂÆö
        function isLocalFile(url) {
            return url.endsWith('.html') || url.endsWith('.htm') || 
                   (!url.includes('://') && !url.includes('.'));
        }
        
        // „É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø
        async function loadLocalFile(filename, frameNumber) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            const title = document.getElementById(`title${frameNumber}`);
            
            loading.classList.remove('hidden');
            
            try {
                // fetch API„Çí‰ΩøÁî®„Åó„Å¶„É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´„ÇíË™≠„ÅøËæº„Åø
                const response = await fetch(filename);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const content = await response.text();
                
                // Base64„Ç®„É≥„Ç≥„Éº„Éâ„Åó„Å¶„Éá„Éº„ÇøURL„Å®„Åó„Å¶Ë®≠ÂÆö
                const dataUrl = 'data:text/html;charset=utf-8,' + encodeURIComponent(content);
                iframe.src = dataUrl;
                
                currentUrls[frameNumber - 1] = filename;
                title.textContent = `„Éö„Éº„Ç∏${frameNumber}: ${filename}`;
                
                // Ë™≠„ÅøËæº„ÅøÂÆå‰∫ÜÂæå„ÅÆÂá¶ÁêÜ
                iframe.onload = function() {
                    loading.classList.add('hidden');
                };
                
            } catch (error) {
                loading.classList.add('hidden');
                console.error('Local file load error:', error);
                showError(frameNumber, `„É≠„Éº„Ç´„É´„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„ÅøÂ§±Êïó: ${filename}\n${error.message}`);
            }
        }
        
        // „Ç®„É©„ÉºË°®Á§∫Èñ¢Êï∞
        function showError(frameNumber, message) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const errorHtml = `
                <html>
                <head>
                    <meta charset="UTF-8">
                    <title>„Ç®„É©„Éº</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            padding: 40px; 
                            background: #f8f9fa; 
                            color: #333;
                        }
                        .error-container { 
                            background: white; 
                            padding: 30px; 
                            border-radius: 8px; 
                            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                            text-align: center;
                        }
                        .error-icon { 
                            font-size: 48px; 
                            color: #e74c3c; 
                            margin-bottom: 20px; 
                        }
                        .error-title { 
                            font-size: 24px; 
                            color: #e74c3c; 
                            margin-bottom: 15px; 
                        }
                        .error-message { 
                            font-size: 16px; 
                            line-height: 1.6; 
                            color: #666;
                            white-space: pre-line;
                        }
                        .retry-btn {
                            background: #3498db;
                            color: white;
                            border: none;
                            padding: 10px 20px;
                            border-radius: 4px;
                            cursor: pointer;
                            font-size: 14px;
                            margin-top: 20px;
                        }
                        .retry-btn:hover {
                            background: #2980b9;
                        }
                    </style>
                </head>
                <body>
                    <div class="error-container">
                        <div class="error-icon">‚ö†Ô∏è</div>
                        <div class="error-title">„Éö„Éº„Ç∏„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</div>
                        <div class="error-message">${message}</div>
                        <button class="retry-btn" onclick="parent.loadPage(${frameNumber})">ÂÜçË©¶Ë°å</button>
                    </div>
                </body>
                </html>
            `;
            iframe.srcdoc = errorHtml;
        }

        // „É¨„Ç§„Ç¢„Ç¶„ÉàÂ§âÊõ¥
        function setLayout(layout) {
            const mainContent = document.getElementById('mainContent');
            const buttons = document.querySelectorAll('.layout-btn');
            
            // „Éú„Çø„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // „É¨„Ç§„Ç¢„Ç¶„Éà„ÇØ„É©„Çπ„ÇíÊõ¥Êñ∞
            mainContent.className = `main-content ${layout}`;
        }

        // „Éö„Éº„Ç∏Êõ¥Êñ∞
        function refreshPage(frameNumber) {
            const iframe = document.getElementById(`iframe${frameNumber}`);
            const loading = document.getElementById(`loading${frameNumber}`);
            
            loading.classList.remove('hidden');
            iframe.src = iframe.src; // Âº∑Âà∂„É™„É≠„Éº„Éâ
        }

        // Êñ∞„Åó„ÅÑ„Çø„Éñ„ÅßÈñã„Åè
        function openInNewTab(frameNumber) {
            const url = currentUrls[frameNumber - 1];
            if (url) {
                window.open(url, '_blank');
            }
        }

        // „Éó„É™„Çª„ÉÉ„ÉàË™≠„ÅøËæº„Åø
        function loadPreset(presetName) {
            const url1Input = document.getElementById('url1');
            const url2Input = document.getElementById('url2');
            
            switch (presetName) {
                case 'local':
                    url1Input.value = 'template_editor.html';
                    url2Input.value = 'template_editor_simple.html';
                    break;
                case 'google':
                    url1Input.value = 'https://www.google.com';
                    url2Input.value = 'https://www.yahoo.co.jp';
                    break;
                case 'news':
                    url1Input.value = 'https://www.nhk.or.jp/news/';
                    url2Input.value = 'https://www.asahi.com/';
                    break;
                case 'github':
                    url1Input.value = 'https://github.com';
                    url2Input.value = 'https://stackoverflow.com';
                    break;
                case 'test':
                    // „ÉÜ„Çπ„ÉàÁî®„ÅÆ„Ç∑„É≥„Éó„É´„Å™HTML„Éö„Éº„Ç∏
                    const testPage1 = `
                        <html>
                        <head><title>„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏1</title></head>
                        <body style="padding: 40px; font-family: Arial, sans-serif; background: #e3f2fd;">
                            <h1 style="color: #1976d2;">„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏1</h1>
                            <p>„Åì„Çå„ÅØ„ÉÜ„Çπ„ÉàÁî®„ÅÆ„Éö„Éº„Ç∏„Åß„Åô„ÄÇ</p>
                            <p>ÁèæÂú®ÊôÇÂàª: ${new Date().toLocaleString()}</p>
                            <div style="background: white; padding: 20px; margin: 20px 0; border-radius: 8px;">
                                <h3>„Çµ„É≥„Éó„É´„Ç≥„É≥„ÉÜ„É≥„ÉÑ</h3>
                                <ul>
                                    <li>È†ÖÁõÆ1</li>
                                    <li>È†ÖÁõÆ2</li>
                                    <li>È†ÖÁõÆ3</li>
                                </ul>
                            </div>
                        </body>
                        </html>
                    `;
                    
                    const testPage2 = `
                        <html>
                        <head><title>„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏2</title></head>
                        <body style="padding: 40px; font-family: Arial, sans-serif; background: #f3e5f5;">
                            <h1 style="color: #7b1fa2;">„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏2</h1>
                            <p>„Åì„Çå„ÅØ2Áï™ÁõÆ„ÅÆ„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„Åß„Åô„ÄÇ</p>
                            <p>ÁèæÂú®ÊôÇÂàª: ${new Date().toLocaleString()}</p>
                            <div style="background: white; padding: 20px; margin: 20px 0; border-radius: 8px;">
                                <h3>Âà•„ÅÆ„Çµ„É≥„Éó„É´„Ç≥„É≥„ÉÜ„É≥„ÉÑ</h3>
                                <table border="1" style="border-collapse: collapse; width: 100%;">
                                    <tr><th style="padding: 8px;">Âàó1</th><th style="padding: 8px;">Âàó2</th></tr>
                                    <tr><td style="padding: 8px;">„Éá„Éº„ÇøA</td><td style="padding: 8px;">„Éá„Éº„ÇøB</td></tr>
                                    <tr><td style="padding: 8px;">„Éá„Éº„ÇøC</td><td style="padding: 8px;">„Éá„Éº„ÇøD</td></tr>
                                </table>
                            </div>
                        </body>
                        </html>
                    `;
                    
                    // „ÉÜ„Çπ„Éà„Éö„Éº„Ç∏„ÇíÁõ¥Êé•Ë™≠„ÅøËæº„Åø
                    document.getElementById('iframe1').srcdoc = testPage1;
                    document.getElementById('iframe2').srcdoc = testPage2;
                    document.getElementById('title1').textContent = '„Éö„Éº„Ç∏1: „ÉÜ„Çπ„Éà„Éö„Éº„Ç∏1';
                    document.getElementById('title2').textContent = '„Éö„Éº„Ç∏2: „ÉÜ„Çπ„Éà„Éö„Éº„Ç∏2';
                    url1Input.value = '„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏1ÔºàÂÜÖËîµÔºâ';
                    url2Input.value = '„ÉÜ„Çπ„Éà„Éö„Éº„Ç∏2ÔºàÂÜÖËîµÔºâ';
                    return; // ÈÄöÂ∏∏„ÅÆË™≠„ÅøËæº„ÅøÂá¶ÁêÜ„Çí„Çπ„Ç≠„ÉÉ„Éó
            }
            
            // ‰∏°Êñπ„ÅÆ„Éö„Éº„Ç∏„ÇíË™≠„ÅøËæº„Åø
            loadPage(1);
            loadPage(2);
        }

        // Enter „Ç≠„Éº„Åß„ÅÆË™≠„ÅøËæº„Åø
        document.getElementById('url1').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loadPage(1);
            }
        });

        document.getElementById('url2').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                loadPage(2);
            }
        });

        // ÂàùÊúüË™≠„ÅøËæº„Åø
        window.addEventListener('load', function() {
            loadPage(1);
            loadPage(2);
        });

        // „Ç¶„Ç£„É≥„Éâ„Ç¶„É™„Çµ„Ç§„Ç∫ÊôÇ„ÅÆÂá¶ÁêÜ
        window.addEventListener('resize', function() {
            // „É¢„Éê„Ç§„É´Ë°®Á§∫ÊôÇ„ÅØÂº∑Âà∂ÁöÑ„Å´Á∏¶‰∏¶„Å≥„Å´
            if (window.innerWidth <= 768) {
                document.getElementById('mainContent').className = 'main-content vertical';
            }
        });
    </script>
</body>
</html>
